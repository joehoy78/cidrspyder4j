package me.joehoy.pentest.modules;

import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.List;

import org.xbill.DNS.ARecord;
import org.xbill.DNS.Lookup;
import org.xbill.DNS.Record;
import org.xbill.DNS.Resolver;
import org.xbill.DNS.SimpleResolver;
import org.xbill.DNS.TextParseException;

public class ResolverUtils {
	
	public static List<String> resolveHostByName(Resolver resolver, String name) {
	    try {

	        Lookup lookup = new Lookup(name);
	        Record[] records = lookup.run();
	        if (records != null) {
	            List<String> addresses = new ArrayList<String>();
	            for (Record record : records) {
	            	if (record instanceof ARecord) {
	            		addresses.add(((ARecord) record).getAddress().getHostAddress());
	            	}
	            }

	            return addresses;
	        } else {
	            return null;
	        }
	    } catch (TextParseException e) {
	        System.err.println("unable to resolve using A record " + name);
	        return null;
	    }
	}

}
