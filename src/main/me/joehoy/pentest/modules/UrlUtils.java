package me.joehoy.pentest.modules;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.List;
import java.util.Map;

public class UrlUtils {
	
	public static String makeHttpBaseUrl(String target) {
		return makeHttpBaseUrl(target, "");
	}
	
	public static String makeHttpBaseUrl(String target, String port) {
		StringBuilder sb = new StringBuilder(256);
		sb.append("http://");
		addTarget(target, port, sb);
		return sb.toString();
	}

	
	public static String makeHttpsBaseUrl(String target) {
		return makeHttpsBaseUrl(target, "");
	}
	
	public static String makeHttpsBaseUrl(String target, String port) {
		StringBuilder sb = new StringBuilder(256);
		sb.append("https://");
		addTarget(target, port, sb);
		return sb.toString();
	}
	
	public static String doGetRequest(URL url) throws IOException {
		String inputLine;
		StringBuilder responseContent = new StringBuilder();
		HttpURLConnection connection = (HttpURLConnection) url.openConnection();
		connection.setRequestMethod("GET");
		BufferedReader requestReader = new BufferedReader(
											new InputStreamReader(connection.getInputStream()));
		while ((inputLine = requestReader.readLine()) != null) {
			responseContent.append(inputLine);
		}
		requestReader.close();
		connection.disconnect();
		return responseContent.toString();
	}
	
	public static Map <String, List<String>> doHeadRequest(URL url) throws IOException {
		HttpURLConnection connection = (HttpURLConnection) url.openConnection();
		connection.setRequestMethod("HEAD");
		return connection.getHeaderFields();
		
	}
	
	static void addTarget(String target, String port, StringBuilder sb) {
		sb.append(target);
		if (!("".equals(port))) {			
			sb.append(":");
			sb.append(port);
		}
	}

}
